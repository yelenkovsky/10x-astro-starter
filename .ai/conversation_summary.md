<conversation_summary>
<decisions>
1. User authentication will be managed by Supabase, with a local `profiles` table to store public user data.
2. The core functionality will be the creation and management of `flashcards`, each having a `front` and `back`.
3. Flashcards can be created in three ways: manually, generated by an AI from a source text, or edited by an AI.
4. A spaced repetition system (SRS) will be implemented to help users study and retain information effectively.
5. All user data will be kept private and secure using PostgreSQL's Row-Level Security (RLS).
6. To comply with data privacy standards like GDPR, deleting a user account will trigger a cascading delete of all their associated data (flashcards, repetition history).
</decisions>

<matched_recommendations>
1. **Core Schema:** The plan to implement `profiles`, `flashcards`, and `user_flashcard_repetition` tables correctly captures the core entities required for the MVP.
2. **Data Integrity:** Using foreign key constraints with `ON DELETE CASCADE` is the correct approach to maintain data integrity and handle user data deletion requirements.
3. **Security:** Enabling Row-Level Security (RLS) on all tables is a critical and relevant recommendation to ensure user data is isolated and protected.
4. **AI-Generation Support:** The inclusion of `origin` and `source_text` columns in the `flashcards` table directly supports the requirement for AI-powered flashcard generation.
5. **Spaced Repetition:** The `user_flashcard_repetition` table, with columns like `interval`, `ease_factor`, and `next_review_date`, provides the necessary foundation for a robust spaced repetition system.
6. **Scalability:** The recommendation to index all foreign key columns is crucial for maintaining query performance as the application scales.
</matched_recommendations>

<prd_planning_summary>
### Main Functional Requirements
1.  **User Authentication:** Users must be able to sign up, log in, and manage their accounts.
2.  **Flashcard CRUD:** Users must have the ability to Create, Read, Update, and Delete flashcards.
3.  **Manual Flashcard Creation:** A user interface for manually inputting the `front` (question) and `back` (answer) of a flashcard.
4.  **AI-Powered Flashcard Generation:** A feature allowing users to submit a larger body of text (up to 10,000 characters) from which the AI will automatically generate a set of relevant flashcards.
5.  **Spaced Repetition System (SRS):** An automated study scheduler that presents flashcards to the user for review at optimal intervals based on their past performance. The system will track user recall difficulty to adjust future review dates.

### Key User Stories & Usage Paths
*   **As a student, I want to manually create flashcards for my exam topics so I can test myself on specific knowledge.**
    *   *Path:* User logs in → Navigates to "Create Card" → Enters text for "Front" and "Back" → Saves the card.
*   **As a lifelong learner, I want to paste my notes from an article and have the app create flashcards for me, so I can save time on manual creation.**
    *   *Path:* User logs in → Navigates to "Generate from Text" → Pastes text into a field → Clicks "Generate" → Reviews and saves the AI-suggested flashcards.
*   **As a user, I want the app to tell me what I need to study each day so I can learn efficiently and remember information for longer.**
    *   *Path:* User logs in → Navigates to their "Dashboard" or "Review" section → Starts a review session → For each card, they view the `front`, recall the answer, view the `back`, and rate their recall difficulty (e.g., "Easy," "Hard") → The app schedules the next review and presents the next card.

### Success Criteria & Measurement
1.  **User Engagement:** Track Daily Active Users (DAU) and the average number of review sessions completed per week. Success is a consistently high ratio of DAU to Monthly Active Users (MAU).
2.  **Feature Adoption:** Monitor the ratio of manually created vs. AI-generated flashcards. Success is seeing significant adoption of the AI generation feature.
3.  **User Retention:** Measure the percentage of new users who create at least one flashcard and complete one review session in their first week.
4.  **Learning Efficacy:** (Long-term) Survey users on their perceived learning effectiveness and retention improvement since using the app.

</prd_planning_summary>

<unresolved_issues>
1.  **Spaced Repetition Algorithm:** The specific algorithm (e.g., a variant of SM-2, FSRS) for calculating `interval`, `ease_factor`, and `next_review_date` is not defined. The logic for how user input (e.g., "Easy," "Good," "Hard") translates to these values needs to be specified.
2.  **AI Service Integration:** The technical details of the AI integration are missing. Which AI model will be used? What will the prompts look like to ensure quality flashcard generation? What are the associated costs and rate limits?
3.  **Review Session UI/UX:** The user experience for a review session is not detailed. How many cards are included in a single session? What does the interface for rating recall look like? What feedback does the user receive during and after the session?
4.  **Content Validation & Limits:** Are there restrictions on the number of flashcards a user can create? What are the precise validation rules for the `front`, `back`, and `source_text` fields beyond the character limits?
</unresolved_issues>
</conversation_summary>
